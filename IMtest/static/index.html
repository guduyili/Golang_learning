<!-- static/index.html -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <title>IM 聊天</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="style.css" />
    <style>
        body,html{height:100%;margin:0;font-family:Arial}
        .layout{display:flex;height:100%}
        .side{width:240px;border-right:1px solid #ddd;display:flex;flex-direction:column}
        .main{flex:1;display:flex;flex-direction:column}
        .head{padding:10px;border-bottom:1px solid #ddd;font-weight:bold}
        .users{flex:1;overflow:auto;padding:8px}
        .user-item{padding:6px 10px;margin-bottom:4px;background:#f7f7f7;border-radius:4px;cursor:pointer;font-size:14px}
        .user-item.active{background:#007bff;color:#fff}
        .user-item:hover{background:#e2e6ea}
        .set-name{padding:8px;border-top:1px solid #eee}
        .chat-head{padding:10px;border-bottom:1px solid #ddd;display:flex;align-items:center;gap:10px}
        .messages{flex:1;overflow:auto;padding:10px;background:#fafafa}
        .msg{margin:0 0 10px;padding:8px 10px;border-radius:6px;background:#fff;font-size:14px;max-width:70%;word-break:break-all}
        .msg.own{background:#e7f8e7;margin-left:auto}
        .msg.sys{background:#eef5ff;text-align:center;max-width:60%}
        .msg.private{border-left:4px solid #ff9800;background:#fff6e6}
        .input-bar{display:flex;gap:8px;padding:10px;border-top:1px solid #ddd}
        .input-bar input{flex:1;padding:8px}
        .mode{font-size:12px;color:#666}
        .badge{padding:2px 6px;border-radius:4px;font-size:12px}
        .badge.ok{background:#28a745;color:#fff}
        .badge.no{background:#dc3545;color:#fff}
        .target{font-size:12px;color:#ff9800;margin-left:auto}
        button{cursor:pointer}
    </style>
</head>
<body>
<div class="layout">
    <div class="side">
        <div class="head">
            在线用户 (<span id="userCount">0</span>)
            <button id="refreshUsersBtn" style="float:right;font-size:12px;padding:2px 6px;cursor:pointer;">刷新</button>
        </div>
        <div id="users" class="users"></div>
        <div class="set-name">
            <input id="nameInput" placeholder="新用户名" style="width:100%;box-sizing:border-box;padding:6px;margin-bottom:6px;font-size:14px">
            <button id="renameBtn" style="width:100%;padding:6px">设置用户名</button>
        </div>
    </div>
    <div class="main">
        <div class="chat-head">
            <span id="modeLabel">公共聊天室</span>
            <button id="publicBtn">公聊</button>
            <button id="privateBtn">私聊</button>
            <span id="status" class="badge no">未连接</span>
            <span id="currentTarget" class="target" style="display:none"></span>
        </div>
        <div id="messages" class="messages"></div>
        <div class="input-bar">
            <input id="msgInput" placeholder="输入消息回车发送 (私聊需先选用户)">
            <button id="sendBtn">发送</button>
        </div>
    </div>
</div>
<script src="app.js"></script>
</body>
</html>